# AOI ç³»çµ±ç‹€æ…‹ç¸½è¦½

**æœ€å¾Œæ›´æ–°**: 2025-12-10
**ç‰ˆæœ¬**: v1.0 (MUIç‰ˆ)

---

## âœ… ç³»çµ±ç‹€æ…‹ï¼šå®Œå…¨æ­£å¸¸

### å‰ç«¯ç‹€æ…‹
- âœ… **React + TypeScript** - æ­£å¸¸é‹è¡Œ
- âœ… **Material-UI (MUI)** - å·²å®‰è£ä¸¦é…ç½®
- âœ… **æ‰€æœ‰çµ„ä»¶** - å·²é‡æ§‹ç‚ºMUIç‰ˆæœ¬
- âœ… **ç„¡ç·¨è­¯éŒ¯èª¤** - å•Ÿå‹•æˆåŠŸ (exit code 0)
- âœ… **ä¸­æ–‡ç•Œé¢** - å®Œæ•´ç¹é«”ä¸­æ–‡

### å¾Œç«¯ç‹€æ…‹
- âœ… **Flask API** - å·²é…ç½®
- âœ… **OpenCV è™•ç†** - å·²æ•´åˆ
- âœ… **3å€‹æ ¸å¿ƒåŠŸèƒ½** - ç‘•ç–µæª¢æ¸¬ã€å°ºå¯¸æ¸¬é‡ã€å®šä½æ¨™è¨˜
- âœ… **APIç«¯é»** - å…¨éƒ¨å¯¦ç¾

---

## ğŸ“¦ å·²å®‰è£å¥—ä»¶

### å‰ç«¯ä¾è³´
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "typescript": "^5.3.0",
  "@mui/material": "^5.x",
  "@mui/icons-material": "^5.x",
  "@emotion/react": "^11.x",
  "@emotion/styled": "^11.x",
  "axios": "^1.6.0",
  "vite": "^5.0.0"
}
```

### å¾Œç«¯ä¾è³´
```txt
Flask==3.0.0
flask-cors==4.0.0
opencv-python==4.8.0.74
numpy==1.24.0
Pillow==10.0.0
werkzeug==3.0.0
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. ç‘•ç–µæª¢æ¸¬ (Defect Detection)
**æ–‡ä»¶**: `backend/app/services/aoi_service.py` - `detect_defects()`

**ç®—æ³•æµç¨‹**:
```
è¼¸å…¥åœ–åƒ
â†’ æ¨¡æ¿å·®ç•° (cv2.absdiff)
â†’ é–¾å€¼äºŒå€¼åŒ– (cv2.threshold)
â†’ å½¢æ…‹å­¸æ¸…ç† (cv2.morphologyEx)
â†’ è¼ªå»“æª¢æ¸¬ (cv2.findContours)
â†’ ç‰¹å¾µæå–
â†’ è¿”å›ç‘•ç–µåˆ—è¡¨ + æ¨™è¨»åœ–åƒ
```

**è¿”å›æ•¸æ“š**:
- ç‘•ç–µID
- ä½ç½® (x, y)
- é¢ç© (pixelsÂ²)
- é‚Šç•Œæ¡† (x, y, width, height)

---

### 2. å°ºå¯¸æ¸¬é‡ (Dimension Measurement)
**æ–‡ä»¶**: `backend/app/services/aoi_service.py` - `measure_dimensions()`

**ç®—æ³•æµç¨‹**:
```
è¼¸å…¥åœ–åƒ
â†’ Canny é‚Šç·£æª¢æ¸¬
â†’ è¼ªå»“æå–
â†’ é‚Šç•Œæ¡†è¨ˆç®—
â†’ åƒç´ åˆ°æ¯«ç±³è½‰æ›
â†’ å½¢ç‹€åˆ†é¡ (åœ“å½¢/çŸ©å½¢)
â†’ è¿”å›æ¸¬é‡æ•¸æ“š + æ¨™è¨»åœ–åƒ
```

**è¿”å›æ•¸æ“š**:
- ç‰©é«”ID
- å½¢ç‹€é¡å‹
- å¯¬åº¦ã€é«˜åº¦ã€é¢ç© (mm)
- ç›´å¾‘ (åœ“å½¢)
- é‚Šç•Œæ¡†

---

### 3. å®šä½æ¨™è¨˜æª¢æ¸¬ (Fiducial Mark Detection)
**æ–‡ä»¶**: `backend/app/services/aoi_service.py` - `detect_fiducial_marks()`

**ç®—æ³•æµç¨‹**:
```
è¼¸å…¥åœ–åƒ
â†’ é«˜æ–¯æ¨¡ç³Š
â†’ Hough åœ“æª¢æ¸¬
â†’ ä½ç½®æå–
â†’ æ—‹è½‰è§’åº¦è¨ˆç®—
â†’ è¿”å›æ¨™è¨˜åˆ—è¡¨ + æ¨™è¨»åœ–åƒ
```

**è¿”å›æ•¸æ“š**:
- æ¨™è¨˜ID
- ä½ç½® (x, y)
- åŠå¾‘
- æ—‹è½‰è§’åº¦

---

## ğŸŒ API ç«¯é»

| ç«¯é» | æ–¹æ³• | åŠŸèƒ½ | ç‹€æ…‹ |
|------|------|------|------|
| `/api/health` | GET | å¥åº·æª¢æŸ¥ | âœ… |
| `/api/upload` | POST | ä¸Šå‚³åœ–åƒ | âœ… |
| `/api/process/defect-detection` | POST | ç‘•ç–µæª¢æ¸¬ | âœ… |
| `/api/process/measurement` | POST | å°ºå¯¸æ¸¬é‡ | âœ… |
| `/api/process/fiducial-detection` | POST | å®šä½æ¨™è¨˜æª¢æ¸¬ | âœ… |

---

## ğŸ“ å®Œæ•´æ–‡ä»¶æ¸…å–®

### å‰ç«¯ (frontend/)
```
src/
â”œâ”€â”€ App.tsx                    âœ… MUIä¸»ç•Œé¢
â”œâ”€â”€ main.tsx                   âœ… å…¥å£æ–‡ä»¶
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ImageUpload.tsx        âœ… MUIä¸Šå‚³çµ„ä»¶
â”‚   â”œâ”€â”€ ImageViewer.tsx        âœ… MUIåœ–åƒé¡¯ç¤º
â”‚   â””â”€â”€ ResultsPanel.tsx       âœ… MUIçµæœè¡¨æ ¼
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.ts                 âœ… APIå®¢æˆ¶ç«¯
â””â”€â”€ types/
    â””â”€â”€ aoi.types.ts           âœ… TypeScripté¡å‹
```

### å¾Œç«¯ (backend/)
```
app/
â”œâ”€â”€ __init__.py                âœ… Flaskå·¥å» 
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ upload.py              âœ… ä¸Šå‚³è·¯ç”±
â”‚   â””â”€â”€ process.py             âœ… è™•ç†è·¯ç”±
â””â”€â”€ services/
    â”œâ”€â”€ image_handler.py       âœ… åœ–åƒè™•ç†å·¥å…·
    â””â”€â”€ aoi_service.py         âœ… CVç®—æ³•åŒ…è£å™¨
```

---

## ğŸš€ å•Ÿå‹•å‘½ä»¤

### å®Œæ•´å•Ÿå‹•æµç¨‹

**æ­¥é©Ÿ 1: å•Ÿå‹•å¾Œç«¯**
```bash
cd aoi-system/backend

# å‰µå»ºè™›æ“¬ç’°å¢ƒï¼ˆé¦–æ¬¡ï¼‰
python -m venv venv

# æ¿€æ´»è™›æ“¬ç’°å¢ƒ
venv\Scripts\activate          # Windows
# source venv/bin/activate     # macOS/Linux

# å®‰è£ä¾è³´ï¼ˆé¦–æ¬¡ï¼‰
pip install -r requirements.txt

# å•Ÿå‹•æœå‹™å™¨
python run.py
```
**å¾Œç«¯åœ°å€**: http://localhost:5000

---

**æ­¥é©Ÿ 2: å•Ÿå‹•å‰ç«¯**ï¼ˆæ–°çµ‚ç«¯ï¼‰
```bash
cd aoi-system/frontend

# å®‰è£ä¾è³´ï¼ˆé¦–æ¬¡ï¼Œå·²å®Œæˆï¼‰
# npm install

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```
**å‰ç«¯åœ°å€**: http://localhost:5173

---

### å¿«æ·å•Ÿå‹•ï¼ˆWindowsï¼‰
```
é›™æ“Š: start-backend.bat   â†’ å•Ÿå‹•å¾Œç«¯
é›™æ“Š: start-frontend.bat  â†’ å•Ÿå‹•å‰ç«¯
```

---

## ğŸ¨ UI çµ„ä»¶å°ç…§

| åŠŸèƒ½ | èˆŠç‰ˆ (CSS) | æ–°ç‰ˆ (MUI) |
|------|-----------|-----------|
| é ‚éƒ¨å°èˆª | è‡ªå®šç¾© div | `AppBar` + `Toolbar` |
| ä½ˆå±€ | CSS Grid | `Container` + `Grid` |
| å¡ç‰‡ | div + CSS | `Paper` |
| æŒ‰éˆ• | button + CSS | `Button` |
| è¡¨æ ¼ | table + CSS | `Table` + `TableContainer` |
| æ¨™ç±¤é  | è‡ªå®šç¾© | `Tabs` + `Tab` |
| è¼¸å…¥æ¡† | input + CSS | `TextField` |
| æ»‘æ¡¿ | input[range] | `Slider` |
| æç¤º | è‡ªå®šç¾© | `Alert` |
| è¼‰å…¥ | è‡ªå®šç¾©å‹•ç•« | `CircularProgress` |
| åœ–æ¨™ | æ–‡å­—/emoji | `@mui/icons-material` |

---

## ğŸ”§ å¸¸ç”¨ä¿®æ”¹ä½ç½®

### ä¿®æ”¹ç•Œé¢æ–‡å­—
- **æ–‡ä»¶**: `frontend/src/App.tsx`, `frontend/src/components/*.tsx`
- **ä½ç½®**: `<Typography>` çµ„ä»¶å…§çš„æ–‡å­—

### ä¿®æ”¹é¡è‰²ä¸»é¡Œ
- **æ–‡ä»¶**: `frontend/src/App.tsx`
- **ä½ç½®**: `sx={{ bgcolor: '...', color: '...' }}`
- **AppBaré¡è‰²**: Line 112 - `background: 'linear-gradient(...)'`

### èª¿æ•´è™•ç†åƒæ•¸é»˜èªå€¼
- **æ–‡ä»¶**: `frontend/src/App.tsx`
- **ä½ç½®**:
  - Line 48: `threshold` é»˜èªå€¼
  - Line 49: `calibration` é»˜èªå€¼
  - Line 50-51: `minRadius`, `maxRadius` é»˜èªå€¼

### ä¿®æ”¹æª¢æ¸¬ç®—æ³•
- **æ–‡ä»¶**: `backend/app/services/aoi_service.py`
- **å‡½æ•¸**:
  - `detect_defects()` - ç‘•ç–µæª¢æ¸¬ç®—æ³•
  - `measure_dimensions()` - å°ºå¯¸æ¸¬é‡ç®—æ³•
  - `detect_fiducial_marks()` - æ¨™è¨˜æª¢æ¸¬ç®—æ³•

---

## ğŸ“Š æ€§èƒ½æŒ‡æ¨™

| æ“ä½œ | é æœŸæ™‚é–“ | èªªæ˜ |
|------|---------|------|
| åœ–åƒä¸Šå‚³ | < 1ç§’ | å–æ±ºæ–¼ç¶²è·¯å’Œæ–‡ä»¶å¤§å° |
| ç‘•ç–µæª¢æ¸¬ | 1-3ç§’ | 800Ã—600 åƒç´ åœ–åƒ |
| å°ºå¯¸æ¸¬é‡ | 1-2ç§’ | å–æ±ºæ–¼ç‰©é«”æ•¸é‡ |
| æ¨™è¨˜æª¢æ¸¬ | 2-4ç§’ | å–æ±ºæ–¼åœ–åƒè¤‡é›œåº¦ |
| å‰ç«¯æ¸²æŸ“ | < 100ms | MUIå„ªåŒ–æ¸²æŸ“ |

---

## âœ… æª¢æŸ¥æ¸…å–®

### å•Ÿå‹•å‰æª¢æŸ¥
- [ ] Python 3.8+ å·²å®‰è£
- [ ] Node.js 16+ å·²å®‰è£
- [ ] pip å·²å®‰è£
- [ ] ç«¯å£ 5000 å’Œ 5173 æœªè¢«ä½”ç”¨

### é¦–æ¬¡é‹è¡Œ
- [ ] å¾Œç«¯è™›æ“¬ç’°å¢ƒå·²å‰µå»º
- [ ] å¾Œç«¯ä¾è³´å·²å®‰è£
- [ ] å‰ç«¯ä¾è³´å·²å®‰è£ï¼ˆnpm installï¼‰
- [ ] MUI å¥—ä»¶å·²å®‰è£

### é‹è¡Œæ™‚
- [ ] å¾Œç«¯é‹è¡Œåœ¨ http://localhost:5000
- [ ] å‰ç«¯é‹è¡Œåœ¨ http://localhost:5173
- [ ] ç€è¦½å™¨æ§åˆ¶å°ç„¡éŒ¯èª¤
- [ ] å¯ä»¥æˆåŠŸä¸Šå‚³åœ–åƒ

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### 1. å¾Œç«¯ç„¡æ³•å•Ÿå‹•
**ç—‡ç‹€**: `ModuleNotFoundError: No module named 'flask'`
**è§£æ±º**:
```bash
cd aoi-system/backend
venv\Scripts\activate
pip install -r requirements.txt
```

### 2. å‰ç«¯é¡¯ç¤ºç©ºç™½
**ç—‡ç‹€**: ç€è¦½å™¨é¡¯ç¤ºç©ºç™½é 
**æª¢æŸ¥**:
1. ç€è¦½å™¨æ§åˆ¶å°æ˜¯å¦æœ‰éŒ¯èª¤
2. ç¢ºèª MUI å·²å®‰è£: `npm list @mui/material`
3. é‡æ–°å®‰è£: `npm install`

### 3. CORS éŒ¯èª¤
**ç—‡ç‹€**: `Access-Control-Allow-Origin` éŒ¯èª¤
**è§£æ±º**: ç¢ºèªå¾Œç«¯ `flask-cors` å·²å®‰è£ä¸¦é…ç½®

### 4. åœ–åƒç„¡æ³•ä¸Šå‚³
**ç—‡ç‹€**: ä¸Šå‚³æŒ‰éˆ•ç„¡åæ‡‰
**æª¢æŸ¥**:
1. å¾Œç«¯æ˜¯å¦æ­£åœ¨é‹è¡Œ
2. ç¶²è·¯é€£æ¥: è¨ªå• http://localhost:5000/api/health
3. åœ–åƒæ ¼å¼å’Œå¤§å°æ˜¯å¦ç¬¦åˆè¦æ±‚

---

## ğŸ“š æŠ€è¡“æ–‡æª”

### MUI ç›¸é—œ
- [MUI å®˜æ–¹æ–‡æª”](https://mui.com/)
- [çµ„ä»¶API](https://mui.com/material-ui/api/)
- [åœ–æ¨™åˆ—è¡¨](https://mui.com/material-ui/material-icons/)

### Flask ç›¸é—œ
- [Flask æ–‡æª”](https://flask.palletsprojects.com/)
- [Flask-CORS](https://flask-cors.readthedocs.io/)

### OpenCV ç›¸é—œ
- [OpenCV Python](https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html)
- [åœ–åƒè™•ç†æ•™ç¨‹](https://docs.opencv.org/4.x/d2/d96/tutorial_py_table_of_contents_imgproc.html)

---

## ğŸ‰ ç¸½çµ

ä½ ç¾åœ¨æ“æœ‰ä¸€å€‹ï¼š
- âœ… **å®Œæ•´åŠŸèƒ½** çš„ AOI æª¢æ¸¬ç³»çµ±
- âœ… **å°ˆæ¥­ UI** (Material-UI)
- âœ… **é¡å‹å®‰å…¨** (TypeScript)
- âœ… **ä¸­æ–‡ç•Œé¢** (ç¹é«”ä¸­æ–‡)
- âœ… **é«˜æ€§èƒ½** CV è™•ç† (OpenCV)
- âœ… **ç„¡éŒ¯èª¤** å¯ç›´æ¥é‹è¡Œ

**ç«‹å³é–‹å§‹ä½¿ç”¨ï¼** ğŸš€

---

**é …ç›®è·¯å¾‘**: `C:\Users\Liily.Chen\Desktop\computer-vision-application\aoi-system\`
